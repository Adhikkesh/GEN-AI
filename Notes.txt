BigQuery DDL for news table:

CREATE TABLE `your-project.your-dataset.news` (
  newsId STRING NOT NULL,
  title STRING,
  description STRING,
  source STRING,
  url STRING,
  category STRING,
  search_query STRING,
  language STRING,
  thumbnail STRING,
  published_at TIMESTAMP,
  ingested_at TIMESTAMP,
  updated_at TIMESTAMP,
  position INT64,
  ingestion_source STRING,
  is_active BOOL,
  raw_data STRUCT<
    date_text STRING,
    position INT64,
    search_metadata_id STRING
  >
);


CREATE EXTENSION IF NOT EXISTS vector;

CREATE TABLE IF NOT EXISTS embeddings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  source_id TEXT NOT NULL,
  content_type TEXT NOT NULL CHECK (content_type IN ('job', 'news')),
  text_to_show TEXT NOT NULL,
  embedding vector(768),  -- text-embedding-004 uses 768 dimensions
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(source_id, content_type)
);

CREATE INDEX ON embeddings USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);
CREATE INDEX ON embeddings (content_type);
CREATE INDEX ON embeddings (source_id);